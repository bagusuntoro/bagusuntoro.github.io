import{_ as S,r as v,i as B,o as p,c as m,a as t,j as c,z as C,B as g,n as y,g as T,C as V,w as r,v as d,F as k,s as _,S as N,q as D,D as I,t as b,E as A,x as U,y as q}from"./index-d101573f.js";import{S as z,N as M}from"./Navbar-fe6fe40f.js";import{C as L}from"./ChatMe-ce333ade.js";import{P as w,D as O}from"./jquery.dataTables-c14926b4.js";const n=s=>(U("data-v-02c9e928"),s=s(),q(),s),J={id:"wrapper"},x={id:"content-wrapper",class:"d-flex flex-column"},E={id:"content"},P=n(()=>t("h1",{class:"h3 mb-0 text-gray-800 text-center mt-4"}," Halaman List Note ",-1)),j={class:"row"},F=n(()=>t("div",{class:"col-1"},null,-1)),K={class:"col-10"},H={class:"row mt-5"},W={class:"col-sm-3"},G=n(()=>t("i",{class:"bi bi-plus"},null,-1)),Q={class:"col-sm-9"},R={class:"table-responsive"},X={key:0,class:"preloader"},Y=n(()=>t("thead",null,[t("tr",null,[t("th",{scope:"col"},"No"),t("th",{scope:"col"},"Location"),t("th",{scope:"col"},"Date"),t("th",{scope:"col"},"Destination"),t("th",{scope:"col"},"Action")])],-1)),Z={scope:"row"},tt={style:{"white-space":"nowrap"}},et={class:"pe-5"},ot={class:"row"},st={class:"col-6"},at=["onClick"],nt=n(()=>t("i",{class:"bi bi-pencil-square"},null,-1)),lt=[nt],it={class:"col-6"},rt=n(()=>t("i",{class:"bi bi-download"},null,-1)),dt=n(()=>t("div",{class:"col-1"},null,-1)),ct={class:"modal fade",id:"editNoteModal",tabindex:"-1",role:"dialog","aria-labelledby":"editNoteModalLabel","aria-hidden":"true"},ut={class:"modal-dialog",role:"document"},pt={class:"modal-content"},ht=n(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editNoteModalLabel"},"Edit Tally Sheet"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"Ã—")])],-1)),mt={class:"modal-body"},_t={class:"mb-3"},bt=n(()=>t("label",{for:"location",class:"form-label"},"Lokasi",-1)),ft={class:"mb-3"},gt=n(()=>t("label",{for:"truck",class:"form-label"},"Nomor Truk",-1)),vt={class:"mb-3"},yt=n(()=>t("label",{for:"location",class:"form-label"},"Tanggal",-1)),kt={class:"mb-3"},Nt=n(()=>t("label",{for:"driver",class:"form-label"},"Supir",-1)),wt={class:"mb-3"},St=n(()=>t("label",{for:"container",class:"form-label"},"Nomor Kontainer",-1)),Bt={class:"mb-3"},Ct=n(()=>t("label",{for:"telp",class:"form-label"},"No Telp",-1)),Tt={class:"mb-3"},$t=n(()=>t("label",{for:"seal",class:"form-label"},"Nomor Seal",-1)),Vt={class:"mb-3"},Dt=n(()=>t("label",{for:"destination",class:"form-label"},"Tujuan",-1)),It={class:"modal-footer"},At=n(()=>t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1));w.use(O);const Ut={data(){return{note:[],user_id:"",role:null,ready:null,form:[],id_note:null}},methods:{test(){this.$router.push({name:"user-input-tumpukan"})},async dataNote(s){const l=await _.get(`https://10.11.10.243/backend/public/api/auth/notes/${s}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.form=l.data.data,this.id_note=s},updateNote(){_.put(`https://10.11.10.243/backend/public/api/auth/notes/${this.id_note}`,this.form,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(s=>{this.showAlert()}).catch(s=>{console.error(s);const l=JSON.stringify(s.message);sessionStorage.setItem("error",l)})},showAlert(){this.$swal("Data Berhasil di update!!").then(()=>{this.ready=null,this.fetchNote(),$("#editNoteModal").modal("hide")})},update(s){this.$router.push({name:"user-update-note",params:{id:s}})},async fetchNote(){try{const s=await _.get(`https://10.11.10.243/backend/public/api/auth/notes-user/${this.user_id}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.note=s.data.data,this.ready=!0}catch(s){console.error(s);const l=JSON.stringify(s.message);sessionStorage.setItem("error",l)}},async confirmDelete(s){(await N.fire({title:"Apakah Anda yakin ingin menghapus data ini?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Hapus",cancelButtonText:"Batal"})).isConfirmed&&(_.delete(`https://10.11.10.243/backend/public/api/auth/notes/${s}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(i=>{console.log(i.data),this.fetchNote()}).catch(i=>{console.error(i);const u=JSON.stringify(i.message);sessionStorage.setItem("error",u)}),await N.fire({title:"Data berhasil dihapus!",icon:"success",timer:1500,timerProgressBar:!0,showConfirmButton:!1}),this.$router.push("/user-note"))}},mounted(){this.fetchNote()},created(){const s=sessionStorage.getItem("token");if(s)try{const[l,i]=s.split("."),u=JSON.parse(atob(l)),o=atob(i),a=JSON.parse(atob(s.split(".")[1])),h=a.exp,e=new Date(h*1e3);console.log("Waktu Kedaluwarsa (UTC):",e.toUTCString()),new Date>e?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const f=a.role;this.user_id=a.id,f!=="user"?this.$router.push("/unauthorized"):(!u||!o)&&this.$router.push("/")}catch(l){console.error("Error decoding token:",l),this.$router.push("/")}else this.$router.push("/")}},qt=Object.assign(Ut,{__name:"NoteView",setup(s){const l=v(!1),i=v(""),u=()=>{l.value=!l.value,i.value=l.value?"toggle-sidebar":""};return(o,a)=>{const h=B("router-link");return p(),m(k,null,[t("div",J,[c(z,{class:C(i.value)},null,8,["class"]),t("div",x,[t("div",E,[c(M,{onToggleSidebar:u}),c(L),P,t("div",j,[F,t("div",K,[t("div",H,[t("div",W,[c(h,{class:"btn blueButton me-2 mb-5",to:"user-input-note"},{default:g(()=>[G,D("Tambah ")]),_:1})]),t("div",Q,[t("button",{type:"button",onClick:a[0]||(a[0]=e=>o.test())},"test")])]),t("div",R,[o.ready?y("",!0):(p(),m("div",X)),o.ready?(p(),T(V(w),{key:1,class:"tableCustom display table table-striped"},{default:g(()=>[Y,t("tbody",null,[(p(!0),m(k,null,I(o.note,(e,f)=>(p(),m("tr",{key:e.id},[t("th",Z,b(f+1),1),t("td",null,b(e.location),1),t("td",tt,b(e.date),1),t("td",null,b(e.destination),1),t("td",et,[t("div",ot,[t("div",st,[t("button",{type:"button",class:"btn btn-warning","data-toggle":"modal","data-target":"#editNoteModal",onClick:zt=>o.dataNote(e.id)},lt,8,at)]),t("div",it,[c(h,{to:{name:"user-laporan",params:{id:e.id}},class:"btn btn-success customDetail"},{default:g(()=>[rt]),_:2},1032,["to"])])])])]))),128))])]),_:1})):y("",!0)])]),dt])]),c(A)])]),t("div",ct,[t("div",ut,[t("div",pt,[ht,t("div",mt,[t("form",null,[t("div",_t,[bt,r(t("input",{type:"text",class:"form-control",id:"location",placeholder:"input barang","onUpdate:modelValue":a[1]||(a[1]=e=>o.form.location=e),disabled:""},null,512),[[d,o.form.location]])]),t("div",ft,[gt,r(t("input",{type:"text",class:"form-control",id:"no_truck",placeholder:"input barang","onUpdate:modelValue":a[2]||(a[2]=e=>o.form.no_truck=e),required:""},null,512),[[d,o.form.no_truck]])]),t("div",vt,[yt,r(t("input",{type:"text",class:"form-control",id:"date","onUpdate:modelValue":a[3]||(a[3]=e=>o.form.date=e),disabled:""},null,512),[[d,o.form.date]])]),t("div",kt,[Nt,r(t("input",{type:"text",class:"form-control",id:"driver",placeholder:"input driver","onUpdate:modelValue":a[4]||(a[4]=e=>o.form.driver=e),required:""},null,512),[[d,o.form.driver]])]),t("div",wt,[St,r(t("input",{type:"text",class:"form-control",id:"no_container",placeholder:"input nomor container","onUpdate:modelValue":a[5]||(a[5]=e=>o.form.no_container=e),required:""},null,512),[[d,o.form.no_container]])]),t("div",Bt,[Ct,r(t("input",{type:"text",class:"form-control",id:"telp",placeholder:"input telp","onUpdate:modelValue":a[6]||(a[6]=e=>o.form.telp=e),required:""},null,512),[[d,o.form.telp]])]),t("div",Tt,[$t,r(t("input",{type:"text",class:"form-control",id:"no_seal",placeholder:"input nomor seal","onUpdate:modelValue":a[7]||(a[7]=e=>o.form.no_seal=e),required:""},null,512),[[d,o.form.no_seal]])]),t("div",Vt,[Dt,r(t("input",{type:"text",class:"form-control",id:"destination",placeholder:"input nomor destination","onUpdate:modelValue":a[8]||(a[8]=e=>o.form.destination=e),required:""},null,512),[[d,o.form.destination]])])])]),t("div",It,[At,t("button",{type:"button",class:"btn blueButton",onClick:a[9]||(a[9]=(...e)=>o.updateNote&&o.updateNote(...e))}," Simpan Perubahan ")])])])])],64)}}}),xt=S(qt,[["__scopeId","data-v-02c9e928"]]);export{xt as default};
