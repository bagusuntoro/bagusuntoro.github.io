import{_ as y,r as g,i as S,o as c,c as d,j as u,z as C,A as B,a as e,n as b,g as D,B as f,C as N,s as v,S as k,N as T,F as x,D as I,t as h,E as $,x as A,y as V}from"./index-d101573f.js";import{P as w,D as z}from"./jquery.dataTables-c14926b4.js";const n=t=>(A("data-v-4e036e62"),t=t(),V(),t),U={id:"wrapper"},E={id:"content-wrapper",class:"d-flex flex-column"},F={id:"content"},O=n(()=>e("h1",{class:"h3 mb-0 text-gray-800 text-center"},"Halaman Tally Sheet",-1)),P={class:"row"},j=n(()=>e("div",{class:"col-1"},null,-1)),H={class:"col-10"},J=n(()=>e("div",{class:"row mt-5"},[e("div",{class:"col-sm-3"}),e("div",{class:"col-sm-9"})],-1)),K={class:"table-responsive"},L={key:0,class:"preloader"},W=n(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"No"),e("th",{scope:"col"},"Location"),e("th",{scope:"col"},"Date"),e("th",{scope:"col"},"Destination"),e("th",{scope:"col"},"Action")])],-1)),q={scope:"row"},G={style:{"white-space":"nowrap"}},M={class:"pe-5"},Q={class:"row"},R={class:"col-4"},X=n(()=>e("i",{class:"bi bi-download"},null,-1)),Y={class:"col-4"},Z=["onClick"],ee=n(()=>e("i",{class:"bi bi-trash3"},null,-1)),te=[ee],se=n(()=>e("div",{class:"col-1"},null,-1));w.use(z);const oe={data(){return{note:[],ready:null}},methods:{async fetchNote(){try{const t=await v.get("https://10.11.10.243/backend/public/api/auth/notes",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.note=t.data.data,this.ready=!0}catch(t){console.error(t)}},async confirmDelete(t){(await k.fire({title:"Apakah Anda yakin ingin menghapus data ini?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Hapus",cancelButtonText:"Batal"})).isConfirmed&&(v.delete(`https://10.11.10.243/backend/public/api/auth/notes/${t}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(s=>{console.log(s.data),this.ready=!1,this.fetchNote()}).catch(s=>{console.error(s)}),await k.fire({title:"Data berhasil dihapus!",icon:"success",timer:1500,timerProgressBar:!0,showConfirmButton:!1}),this.$router.push("/admin-note"))}},created(){const t=new Date().toUTCString();console.log("Waktu Sekarang (UTC):",t);const o=sessionStorage.getItem("token");if(o)try{const[s,_]=o.split("."),r=JSON.parse(atob(s)),p=atob(_),i=JSON.parse(atob(o.split(".")[1])),a=i.exp,l=new Date(a*1e3);console.log("Waktu Kedaluwarsa (UTC):",l.toUTCString()),new Date>l?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const m=i.role;this.name=i.name,this.alamat=i.alamat,m!=="admin"?this.$router.push("/unauthorized"):(!r||!p)&&(this.$router.push("/"),sessionStorage.removeItem("token")),this.fetchNote()}catch(s){console.error("Error decoding token:",s),this.$router.push("/")}else this.$router.push("/")}},ae=Object.assign(oe,{__name:"NoteView",setup(t){const o=g(!1),s=g(""),_=()=>{o.value=!o.value,s.value=o.value?"toggle-sidebar":""};return(r,p)=>{const i=S("router-link");return c(),d("div",U,[u(B,{class:C(s.value)},null,8,["class"]),e("div",E,[e("div",F,[u(T,{onToggleSidebar:_}),O,e("div",P,[j,e("div",H,[J,e("div",K,[r.ready?b("",!0):(c(),d("div",L)),r.ready?(c(),D(N(w),{key:1,class:"display table table-striped"},{default:f(()=>[W,e("tbody",null,[(c(!0),d(x,null,I(r.note,(a,l)=>(c(),d("tr",{key:a.id},[e("th",q,h(l+1),1),e("td",null,h(a.location),1),e("td",G,h(a.date),1),e("td",null,h(a.destination),1),e("td",M,[e("div",Q,[e("div",R,[u(i,{to:{name:"admin-laporan",params:{id:a.id}},class:"btn btn-success customDetail"},{default:f(()=>[X]),_:2},1032,["to"])]),e("div",Y,[e("button",{onClick:m=>r.confirmDelete(a.id),class:"btn btn-danger customDetail"},te,8,Z)])])])]))),128))])]),_:1})):b("",!0)])]),se])]),u($)])])}}}),ie=y(ae,[["__scopeId","data-v-4e036e62"]]);export{ie as default};
