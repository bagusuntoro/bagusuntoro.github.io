import{_ as k,r as v,i as w,o as m,c as g,j as h,z as f,A as S,a as t,B as I,t as o,F as T,D as y,q as u,n as D,s as b,N as C,E as F,x as $,y as N,I as E}from"./index-d101573f.js";import{h as B}from"./html2pdf.es-190acb1f.js";import"./_commonjs-dynamic-modules-302442b1.js";const n=e=>($("data-v-30022c6f"),e=e(),N(),e),L={key:0,id:"wrapper"},P={id:"content-wrapper",class:"d-flex flex-column"},V={id:"content"},A={id:"app",ref:"document"},U={class:"row mt-4"},z=n(()=>t("div",{class:"col-1"},null,-1)),O={class:"col-10"},H={class:"row"},R={class:"col-6"},j={class:"col-6"},M=n(()=>t("div",{class:"col-1"},null,-1)),X={id:"element-to-convert"},Y={class:"text-black"},J={class:"row mt-5"},K=n(()=>t("div",{class:"col-1"},null,-1)),q={class:"col-10 text-center bg-white"},W=n(()=>t("img",{src:E,alt:"logo",width:"60"},null,-1)),G=n(()=>t("h5",{class:"fw-bold mt-3"},"TALLY SHEET",-1)),x=n(()=>t("div",{class:"col-1"},null,-1)),Q={class:"row"},Z=n(()=>t("div",{class:"col-1"},null,-1)),tt={class:"col-10 bg-white"},ot={class:"row"},st={class:"col-6"},et={class:"col-6"},nt={class:"row"},at={class:"col-6"},lt={class:"col-6"},ct={class:"row"},it={class:"col-6"},dt={class:"col-6"},rt={class:"row"},ht={class:"col-6"},ut=n(()=>t("div",{class:"col-6"},null,-1)),_t=n(()=>t("div",{class:"col-1"},null,-1)),pt={class:"row"},mt=n(()=>t("div",{class:"col-1"},null,-1)),gt={class:"col-10 bg-white"},vt={class:"table-responsive"},wt={class:"table"},bt=n(()=>t("thead",null,[t("tr",null,[t("th",{scope:"col"},"No"),t("th",{scope:"col"},"Jenis Barang"),t("th",{scope:"col"},"1"),t("th",{scope:"col"},"2"),t("th",{scope:"col"},"3"),t("th",{scope:"col"},"4"),t("th",{scope:"col"},"5"),t("th",{scope:"col"},"6"),t("th",{scope:"col"},"7"),t("th",{scope:"col"},"8"),t("th",{scope:"col"},"9"),t("th",{scope:"col"},"10"),t("th",{scope:"col"},"Total")])],-1)),kt={scope:"row"},ft=n(()=>t("div",{class:"col-1"},null,-1)),St={class:"row"},It=n(()=>t("div",{class:"col-1"},null,-1)),Tt={class:"col-10 bg-white"},yt={class:"row"},Dt=n(()=>t("div",{class:"col-1"},null,-1)),Ct={class:"col-11"},Ft={class:"float-end"},$t={class:"row"},Nt={class:"col-5 text-center"},Et=n(()=>t("p",null,"pelanggan",-1)),Bt=["src"],Lt={class:"fw-bold"},Pt=n(()=>t("div",{class:"col-2"},null,-1)),Vt={class:"col-5 text-center"},At=n(()=>t("p",null,"Petugas",-1)),Ut=["src"],zt={class:"fw-bold"},Ot=n(()=>t("div",{class:"col-1"},null,-1)),Ht={class:"row"},Rt=n(()=>t("div",{class:"col-1"},null,-1)),jt={class:"col-10 bg-white"},Mt={class:"row"},Xt={class:"col-6"},Yt=n(()=>t("div",{class:"col-6"},null,-1)),Jt={class:"row mt-2"},Kt=n(()=>t("div",{class:"col-1"},null,-1)),qt={props:["id"],data(){return{note:[],name:"",now:{},romawi:null,tahun:null,alamat:null,pdfFile:null,noTallySheet:"",showContent:!1}},methods:{exportToPDF(){const e=document.getElementById("element-to-convert");B().from(e).output("blob").then(a=>{this.pdfFile=new Blob([a],{type:"application/pdf"});const c=new FormData;c.append("file",this.pdfFile,"surat_pengantar.pdf"),b.post(`http://localhost:8000/api/export/${this.id}`,c,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(i=>{if(!i.data.message)throw new Error("Gagal mengirimkan PDF ke API.");this.downloadPDF()}).catch(i=>{console.error(i)})}).catch(a=>{console.error("Error converting to PDF:",a)})},downloadPDF(){if(this.pdfFile){const e=URL.createObjectURL(this.pdfFile),a=document.createElement("a");a.href=e,a.download=`${this.noTallySheet}.pdf`,a.click()}},getRomanMonth(e){const a=["","I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],[c,i,s]=e.split("-"),d=parseInt(i,10);return this.tahun=s,a[d]},async fetchData(){const e=await b.get(`https://10.11.10.243/backend/public/api/auth/note-detail/${this.id}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.note=e.data.data[0],console.log("test note: ",this.note),this.romawi=this.getRomanMonth(this.note.date),this.noTallySheet=`0${this.id}/TALLYSHEET/${this.romawi}/${this.tahun}`},getCurrentDateTime(){const e=new Date,a=String(e.getDate()).padStart(2,"0"),c=String(e.getMonth()+1).padStart(2,"0"),i=e.getFullYear(),s=String(e.getHours()).padStart(2,"0"),d=String(e.getMinutes()).padStart(2,"0"),r=String(e.getSeconds()).padStart(2,"0");this.now={date:`${a}-${c}-${i}`,time:`${s}:${d}:${r}`}},timeOut(){setTimeout(()=>{this.showContent=!0},3e3)}},mounted(){const e=document.querySelector("body");e.style.backgroundImage="url(/img/wilayah.png)",e.style.backgroundRepeat="no-repeat",e.style.backgroundSize="cover",this.timeOut(),this.getCurrentDateTime()},created(){const e=new Date().toUTCString();console.log("Waktu Sekarang (UTC):",e);const a=sessionStorage.getItem("token");if(a)try{const[c,i]=a.split("."),s=JSON.parse(atob(c)),d=atob(i),r=JSON.parse(atob(a.split(".")[1])),_=r.exp,l=new Date(_*1e3);console.log("Waktu Kedaluwarsa (UTC):",l.toUTCString()),new Date>l?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const p=r.role;this.name=r.name,this.alamat=r.alamat,p!=="admin"?this.$router.push("/unauthorized"):(!s||!d)&&this.$router.push("/"),this.fetchData()}catch(c){console.error("Error decoding token:",c),this.$router.push("/")}else this.$router.push("/")}},Wt=Object.assign(qt,{__name:"Laporan",setup(e){const a=v(!1),c=v(""),i=()=>{a.value=!a.value,c.value=a.value?"toggle-sidebar":""};return(s,d)=>{const r=w("router-link"),_=w("Barcode");return s.showContent?(m(),g("div",L,[h(S,{class:f(c.value)},null,8,["class"]),t("div",P,[t("div",V,[h(C,{onToggleSidebar:i}),t("div",A,[t("div",U,[z,t("div",O,[t("div",H,[t("div",R,[h(r,{to:"/admin-note",class:"btn btn-danger mb-5"},{default:I(()=>[u("Kembali")]),_:1})]),t("div",j,[t("button",{onClick:d[0]||(d[0]=(...l)=>s.exportToPDF&&s.exportToPDF(...l)),class:"btn btn-success float-end"}," Export to PDF ")])])]),M]),t("div",X,[t("div",Y,[t("div",J,[K,t("div",q,[W,G,t("p",null," No. 0"+o(s.note.id)+"/TALLYSHEET/"+o(s.romawi)+"/"+o(this.tahun),1)]),x]),t("div",Q,[Z,t("div",tt,[t("div",ot,[t("div",st,[t("p",null,"Lokasi : "+o(s.note.location),1)]),t("div",et,[t("p",null,"No. Truck : "+o(s.note.no_truck),1)])]),t("div",nt,[t("div",at,[t("p",null,"Tanggal : "+o(s.note.date),1)]),t("div",lt,[t("p",null,"Supir : "+o(s.note.driver),1)])]),t("div",ct,[t("div",it,[t("p",null,"No. Container : "+o(s.note.no_container),1)]),t("div",dt,[t("p",null,"No. HP : "+o(s.note.telp),1)])]),t("div",rt,[t("div",ht,[t("p",null,"No. Tujuan : "+o(s.note.destination),1)]),ut])]),_t]),t("div",pt,[mt,t("div",gt,[t("div",vt,[t("table",wt,[bt,t("tbody",null,[(m(!0),g(T,null,y(s.note.tumpukans,(l,p)=>(m(),g("tr",{key:l.id},[t("th",kt,o(p+1),1),t("td",null,o(l.barang),1),t("td",null,o(l.tumpukan_1),1),t("td",null,o(l.tumpukan_2),1),t("td",null,o(l.tumpukan_3),1),t("td",null,o(l.tumpukan_4),1),t("td",null,o(l.tumpukan_5),1),t("td",null,o(l.tumpukan_6),1),t("td",null,o(l.tumpukan_7),1),t("td",null,o(l.tumpukan_8),1),t("td",null,o(l.tumpukan_9),1),t("td",null,o(l.tumpukan_10),1),t("td",null,o(l.total),1)]))),128))])])])]),ft]),t("div",St,[It,t("div",Tt,[t("div",yt,[Dt,t("div",Ct,[t("p",Ft,o(s.note.location)+", "+o(s.note.date),1)])]),t("div",$t,[t("div",Nt,[Et,t("img",{src:s.note.signatures[0].supir_signature,alt:"tandatangan supir",class:"imageCustom",width:"130"},null,8,Bt),t("h5",null,[u(" ("),t("span",Lt,o(s.note.signatures[0].supir),1),u(") ")])]),Pt,t("div",Vt,[At,t("img",{src:s.note.signatures[0].petugas_signature,alt:"tandatangan petugas",class:"imageCustom",width:"130"},null,8,Ut),t("h5",null,[u(" ("),t("span",zt,o(s.note.signatures[0].petugas),1),u(") ")])])])]),Ot]),t("div",Ht,[Rt,t("div",jt,[t("div",Mt,[t("div",Xt,[h(_)]),Yt]),t("div",Jt,[t("small",null,"Dokument ini dicetak oleh: "+o(s.name),1),t("small",null,"Dokument ini dicetak pada: "+o(s.now.date)+" "+o(s.now.time),1)])]),Kt])])])],512)]),h(F)])])):D("",!0)}}}),Zt=k(Wt,[["__scopeId","data-v-30022c6f"]]);export{Zt as default};
