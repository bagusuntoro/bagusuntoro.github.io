import{_ as b,r as f,o as w,c as v,a as s,j as u,z as h,A as k,t as i,q as c,w as n,v as m,F as y,s as _,N as P,E as M,x as S,y as I}from"./index-d101573f.js";const r=t=>(S("data-v-5d886c69"),t=t(),I(),t),N={id:"wrapper"},B={id:"content-wrapper",class:"d-flex flex-column"},U={id:"content"},C={class:"container-fluid"},D={class:"row"},T={class:"col-md-4"},V={class:"card"},F=["src"],A={class:"card-body"},E={class:"card-title"},z=r(()=>s("button",{type:"button",class:"btn blueButton","data-toggle":"modal","data-target":"#editProfileModal"}," Edit Profile ",-1)),K={class:"col-md-8"},L=r(()=>s("h2",{class:"h3 mb-2 mt-2 text-gray-800 text-center"},"Profil Pengguna",-1)),O={class:"list-group"},j={class:"list-group-item"},J=r(()=>s("strong",null,"Nama:",-1)),R={class:"list-group-item"},q=r(()=>s("strong",null,"Lokasi:",-1)),G={class:"list-group-item"},H=r(()=>s("strong",null,"NIK:",-1)),W={class:"list-group-item"},Q=r(()=>s("strong",null,"Email:",-1)),X={class:"list-group-item"},Y=r(()=>s("strong",null,"Telepon:",-1)),Z={class:"modal fade",id:"editProfileModal",tabindex:"-1",role:"dialog","aria-labelledby":"editProfileModalLabel","aria-hidden":"true"},x={class:"modal-dialog",role:"document"},ss={class:"modal-content"},os=r(()=>s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProfileModalLabel"}," Edit Profil Pengguna "),s("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[s("span",{"aria-hidden":"true"},"Ã—")])],-1)),es={class:"modal-body"},ts={class:"form-group"},as=r(()=>s("label",{for:"gambar"},"Gambar",-1)),rs={class:"form-group"},ls=r(()=>s("label",{for:"nama"},"Nama",-1)),is={class:"form-group"},ds=r(()=>s("label",{for:"nik"},"NIK",-1)),ns={class:"form-group"},ms=r(()=>s("label",{for:"telp"},"Telp",-1)),cs={class:"form-group"},ps=r(()=>s("label",{for:"email"},"Email",-1)),us={class:"form-group"},hs=r(()=>s("label",{for:"password"},"Password",-1)),fs={class:"form-group"},gs=r(()=>s("label",{for:"kopass"},"Konfirmasi Password",-1)),_s={class:"modal-footer"},bs=r(()=>s("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1));f("");const ws={data(){return{role:null,form:[],user_id:"",passwordMatch:!1,passwordMismatch:!1}},methods:{previewFiles(){const t=this.$refs.myImage.files[0];this.fileName=t.name;const l=new FileReader;l.readAsDataURL(t),l.onload=d=>{this.form.gambar=d.target.result}},async fetchUser(){try{const t=await _.get(`https://10.11.10.243/backend/public/api/auth/user-detail/${this.user_id}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.form=t.data.data}catch(t){console.error(t)}},checkPasswordMatch(){this.form.password===this.form.confirmPassword?(this.passwordMatch=!0,this.passwordMismatch=!1):(this.passwordMatch=!1,this.passwordMismatch=!0)},saveChanges(){let t=new FormData;t.append("name",this.form.name),t.append("gambar",this.$refs.myImage.files[0]),t.append("nik",this.form.nik),t.append("telp",this.form.telp),t.append("email",this.form.email),t.append("password",this.form.password),_.post(`https://10.11.10.243/backend/public/api/auth/user-update/${this.user_id}`,t,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(l=>{console.log(l),this.showAlert()})},showAlert(){this.$swal("Data Berhasil di update!!").then(()=>{$("#editProfileModal").modal("hide")})}},created(){const t=sessionStorage.getItem("token");if(t)try{const[l,d]=t.split("."),p=JSON.parse(atob(l)),o=atob(d);console.log("Header:",p),console.log("Signature:",o);const e=JSON.parse(atob(t.split(".")[1]));console.log("test: ",e);const a=e.exp,g=new Date(a*1e3);console.log("Waktu Kedaluwarsa (UTC):",g.toUTCString()),new Date>g?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman"),this.role=e.role,this.user_id=e.id,this.role!=="admin"?this.$router.push("/unauthorized"):(!p||!o)&&this.$router.push("/"),this.fetchUser()}catch(l){console.error("Error decoding token:",l),this.$router.push("/")}else this.$router.push("/")}},vs=Object.assign(ws,{__name:"Profile",setup(t){const l=f(!1),d=f(""),p=()=>{l.value=!l.value,d.value=l.value?"toggle-sidebar":""};return(o,e)=>(w(),v(y,null,[s("div",N,[u(k,{class:h(d.value)},null,8,["class"]),s("div",B,[s("div",U,[u(P,{onToggleSidebar:p}),s("div",C,[s("div",D,[s("div",T,[s("div",V,[s("img",{src:"https://10.11.10.243/backend/public/storage/profile/"+o.form.gambar,alt:" gambarprofile",class:"card-img-top"},null,8,F),s("div",A,[s("h5",E,i(o.form.name),1),z])])]),s("div",K,[L,s("ul",O,[s("li",j,[J,c(" "+i(o.form.name),1)]),s("li",R,[q,c(" "+i(o.form.namaLokasi),1)]),s("li",G,[H,c(" "+i(o.form.nik),1)]),s("li",W,[Q,c(" "+i(o.form.email),1)]),s("li",X,[Y,c(" "+i(o.form.telp),1)])])])])])]),u(M)])]),s("div",Z,[s("div",x,[s("div",ss,[os,s("div",es,[s("form",null,[s("div",ts,[as,s("input",{type:"file",class:"form-control",id:"gambar",name:"gambar",ref:"myImage",onChange:e[0]||(e[0]=(...a)=>o.previewFiles&&o.previewFiles(...a))},null,544),s("small",null,i(o.form.gambar),1)]),s("div",rs,[ls,n(s("input",{type:"text",class:"form-control",id:"nama","onUpdate:modelValue":e[1]||(e[1]=a=>o.form.name=a)},null,512),[[m,o.form.name]])]),s("div",is,[ds,n(s("input",{type:"number",class:"form-control",id:"nik","onUpdate:modelValue":e[2]||(e[2]=a=>o.form.nik=a)},null,512),[[m,o.form.nik]])]),s("div",ns,[ms,n(s("input",{type:"number",class:"form-control",id:"telp","onUpdate:modelValue":e[3]||(e[3]=a=>o.form.telp=a)},null,512),[[m,o.form.telp]])]),s("div",cs,[ps,n(s("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":e[4]||(e[4]=a=>o.form.email=a)},null,512),[[m,o.form.email]])]),s("div",us,[hs,n(s("input",{type:"password",class:h(["form-control",{"error-border":o.passwordMismatch,"success-border":o.passwordMatch}]),id:"password","onUpdate:modelValue":e[5]||(e[5]=a=>o.form.password=a),onInput:e[6]||(e[6]=(...a)=>o.checkPasswordMatch&&o.checkPasswordMatch(...a))},null,34),[[m,o.form.password]])]),s("div",fs,[gs,n(s("input",{type:"password",class:h(["form-control",{"error-border":o.passwordMismatch,"success-border":o.passwordMatch}]),id:"kopass","onUpdate:modelValue":e[7]||(e[7]=a=>o.form.confirmPassword=a),onInput:e[8]||(e[8]=(...a)=>o.checkPasswordMatch&&o.checkPasswordMatch(...a))},null,34),[[m,o.form.confirmPassword]])])])]),s("div",_s,[bs,s("button",{type:"button",class:"btn blueButton",onClick:e[9]||(e[9]=(...a)=>o.saveChanges&&o.saveChanges(...a))}," Simpan Perubahan ")])])])])],64))}}),ys=b(vs,[["__scopeId","data-v-5d886c69"]]);export{ys as default};
